-# locals: instance

%script#person_list_item{ 'type': 'text/html', 'data-member': 'object_person', 'data-role': 'Accountable' }
  %li{ 'data-id': '<%= person.id %>', 'class': 'controlSlot tree-item' }
    .item-main
      .simple-link
        .row-fluid
          .span12
            .item-data
              .tree-title-area
                %a{ 'href': 'mailto:<%= person.email %>', 'rel': 'tooltip', 'title': '<%= person.email %>' }
                  <%= person.name && person.name.trim() || person.email %>
                %span.role
                  <%= role %>

%ul#personList.new-tree{ 'data-template-id': 'person_list_item' }
  -for object_item in instance.object_people
    -set item = object_item.person
    %li{ 'data-id': '={ item.id }', 'class': 'tree-item' }
      .item-main
        .simple-link
          .row-fluid
            .span12
              .item-data
                .tree-title-area
                  -if item.name and item.email
                    %a{ 'href': 'mailto:={ item.email }', 'target': '_blank', 'rel': 'tooltip', 'title': '={ item.email }' }
                      =item.name
                  -elif item.name
                    =item.name
                  -elif item.email
                    %a{ 'href': 'mailto:={ item.email }', 'target': '_blank' }
                      =item.email
                  -else
                    ="&nbsp".html_safe
                  %span.role
                    =object_item.role

  %li.tree-item-add
    %a{ 'href': 'javascript://', 'data-toggle': 'modal-selector', 'data-modal-selector-options': 'object_people', 'data-list-target': '#personList', 'data-modal-class': 'modal-wide', 'rel': 'tooltip', 'data-placement': 'left', 'title': 'Add People' }
      .row-fluid
        .span12
          + Person
