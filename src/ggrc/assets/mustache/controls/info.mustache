{{!
    Copyright (C) 2013 Google Inc., authors, and contributors <see AUTHORS file>
    Licensed under http://www.apache.org/licenses/LICENSE-2.0 <see LICENSE file>
    Created By: brad@reciprocitylabs.com
    Maintained By: brad@reciprocitylabs.com
}}

<section class="info">
  {{#instance}}
  <div class="row-fluid">
    <div class="span6">
      <h3><strong>{{title}}</strong></h3>
      {{#if type}}
      <p>
        {{type.title}}
      </p>
      {{/if}}
    </div>
    <div class="span6">&nbsp;</div>
  </div>
  <div class="row-fluid">
    <div class="span6">
      <div class="rtf-block">
        {{{firstnonempty description '<h4 class="no-data">No description</h4>'}}}
      </div>
    </div>
    <div class="span6">
      {{#if owners.length}}
        {{#using contacts=owners}}
        {{#contacts}}
          <p>
            <strong>Owner</strong>
            <br>
            <span>{{firstnonempty name email}}</span>
          </p>
        {{/contacts}}
        {{/using}}
      {{else}}
        <p>
          <strong>Owner</strong>
          <br>
          <span class="error">
            Not Assigned
          </span>
        </p>
      {{/if}}
      
      {{#using contact=contact}}
      {{#if contact}}
        <p>
          <strong>Contact</strong>
          <br>
          <span>{{firstnonempty contact.name contact.email}}</span>
        </p>
      {{else}}
        <p>
          <strong>Contact</strong>
          <br>
          <span class="error">
            Not Assigned
          </span>
        </p>
      {{/if}}
      {{/using}}
    </div>
  </div>
  <div class="row-fluid">
    <div class="span6">
      <div class="rtf-block">
        <strong>Notes</strong>
        <br>
        {{{firstnonempty notes '<h4 class="no-data">No notes available</h4>'}}}
      </div>
    </div>
    <div class="span6">
      <p>
        <strong>{{model.title_singular}} URL</strong>
        <br>
        <a href="{{schemed_url url}}" class="inner-element" target="_blank">
          {{url}}
        </a>
      </p>
      <p>
        <strong>Reference URL</strong>
        <br>
        <a href="{{schemed_url url}}" class="inner-element" target="_blank">
          {{reference_url}}
        </a>
      </p>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span12">
      <div class="info-expand">
        <a class="show-hidden-fields info-show-hide" href="javascript://">
          <span class="out">
            <i class="grcicon-show"></i>
            Show 
          </span>
          <span class="in">
            <i class="grcicon-hide"></i>
            Hide
          </span>
          Advanced
          <span class="hidden-fields out">
            Code, Kind/Nature, Fraud-Related, Significance, Type/Means, Notes, Effective Date, Stop Date, Frequency, Assertions, Categories, Principal Assessor, Secondary Assessor, State
          </span>
        </a>
      </div>
    </div>
  </div>
  <div class="hidden-fields-area" style="display:none;">
    <div class="row-fluid">
      <div class="span6">
        <p>
          <strong>Code</strong>
          <br>
          <span>{{slug}}</span>
        </p>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <p>
          <strong>Kind/Nature</strong>
          <br>
          {{control_kind}}
        </p>
      </div>
      <div class="span3">
        <p>
          <strong>Fraud Related</strong>
          <br>
          {{fraud_related}}
        </p>
      </div>
      <div class="span3">
        <p>
          <strong>Significance</strong>
          <br>
          {{key_control}}
        </p>
      </div>
      <div class="span3">
        <p>
          <strong>Type/Means</strong>
          <br>
          {{control_means}}
        </p>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span6">
        <p>
          <strong>Effective Date</strong>
          <br>
          <span>{{localize_date start_date}}</span>
        </p>
      </div>
      <div class="span6">
        <p>
          <strong>Stop Date</strong>
          <br>
          <span>{{localize_date end_date}}</span>
        </p>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span4">
        <p>
          <strong>Frequency</strong>
          <br>
          <span>{{verify_frequency}}</span>
        </p>
      </div>
      <div class="span4">
        <p>
          <strong>Assertions</strong>
          <br>
          <span>{{ControlAssertion}}</span>
        </p>
      </div>
      <div class="span4">
        <p>
          <strong>Categories</strong>
          <br>
          <span>{{ControlCategory}}</span>
        </p>
      </div>
    </div>
    <div class="row-fluid">
      <div class="span4">
        <p>
          <strong>Principal Assessor</strong>
          <br>
          {{#using contact=instance.contact}}
          <span>{{firstnonempty contact.email ''}}</span>
          {{/using}}
        </p>
      </div>
      <div class="span4">
        <p>
          <strong>Secondary Assessor</strong>
          <br>
          {{#using contact=instance.contact}}
          <span>{{firstnonempty contact.email ''}}</span>
          {{/using}}
        </p>
      </div>
      <div class="span4">
        <p>
          <strong>State</strong>
          <br>
          <span>{{state}}</span>
        </p>
      </div>
    </div>
  </div>
  <div class="info-widget-footer">
    {{#is_allowed 'update' instance context='for'}}
    <p class="pull-right">
      <a href="javascript://" class="info-edit" data-toggle="modal-ajax-form" data-object-plural="{{model.table_plural}}" data-object-singular="{{model.model_singular}}" data-modal-reset="reset" data-modal-class="modal-wide" title="Edit {{model.model_title}}" data-object-id="page">
        <i class="grcicon-edit"></i>
        <span>Edit {{model.model_title}}</span>
      </a>
    </p>
    {{/is_allowed}}
    <p>
      <small>
        <em>
          Created by {{#if owners.length}}{{#using contacts=owners}}{{#contacts}}{{firstnonempty name email}}{{/contacts}}{{/using}}{{/if}} at {{date created_at}}
          <br>
          Modified by {{date modified_at}}
        </em>
      </small>
    </p>
  </div>
  {{/instance}}
</section>
