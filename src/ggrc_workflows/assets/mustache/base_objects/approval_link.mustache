<li data-object-id="{{instance.id}}"
    data-object-type="{{instance.class.table_singular}}" {{#instance}}{{data 'model'}}{{/instance}}>
  {{#if_equals instance.status 'Final'}}
    <i class="grcicon-review-color"></i>
    <span class="object-approved">Reviewed and approved</span>
  {{else}}
    {{#with_mapping 'current_object_review_tasks' instance}}
      {{#with_review_task}}
        {{#if_helpers '\
          #owned_by_current_user' instance '\
          or #current_user_is_admin'}}
          {{#if_equals instance.os_state 'Declined'}}
            {{#with_mapping 'cycle_task_group_object' review_task}}
              {{#using tgo=review_task.cycle_task_group_object}}
                {{#using obj=tgo.object}}
                  <div>Review was declined on {{#date obj.os_last_updated true}}{{/date}}.</div>
                {{/using}}
              {{/using}}
            {{/with_mapping}}
          {{/if_equals}}
        {{/if_helpers}}
        {{#with_is_reviewer review_task}}
          {{#if is_reviewer}}
            <div {{#review_task}}{{data 'model'}}{{/review_task}} {{ (el) -> el.ggrc_controllers_quick_form({instance : el.data("model") }) }}>
              <span class="setup-link">Approval applies only to this object and not to mapped objects.</span>
              <button class="btn btn-mini btn-success change-task-status {{instance._disabled}}" data-name="status" data-value="Verified">Approve</button>
              <a class="btn btn-mini btn-danger change-task-status {{instance._disabled}}" data-name="status" data-value="Declined"
                data-placement="right" data-original-title="Decline Review" data-toggle="modal-ajax-form"
                data-modal-reset="reset" data-modal-class="modal-wide" data-object-singular="CycleTaskEntry"
                data-modal-title-override="Decline Review"
                data-href="#"
                data-allow-propagation="true"
                data-object-plural="cycle_task_entries"
                data-object-params='{\
                  "cycle" : {{review_task.cycle.id}}, \
                  "cycle_task_group_object_task" : {{review_task.id}} \
                }'>Decline</a>
            </div>
          {{else}}
            {{#if_helpers '\
              #owned_by_current_user' instance '\
              or #current_user_is_admin'}}
              {{#with_mapping_count instance 'current_approval_cycles'}}
                {{#if_equals count 0}}
                  <a href="javascript://" class="non-transparent" data-toggle="modal-ajax-approvalform" data-object-singular="{{model.model_singular}}" data-object-id="page">
                    <i class="grcicon-review"></i>
                    Submit For Review
                  </a>
                {{else}}
                  <i class="grcicon-review"></i>
                  <span class="setup-link">Review in progress</span>
                {{/if_equals}}
              {{/with_mapping_count}}
            {{/if_helpers}}
          {{/if}}
        {{/with_is_reviewer}}
      {{/with_review_task}}
    {{/with_mapping}}
  {{/if_equals}}
</li>
